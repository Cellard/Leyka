function is_email(e){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(e)}function leyka_get_ajax_url(){return"undefined"!=typeof leyka?leyka.ajaxurl:"undefined"!=typeof frontend?frontend.ajaxurl:"/"}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function n(e){return s.raw?e:encodeURIComponent(e)}function a(e){return s.raw?e:decodeURIComponent(e)}function t(e){return n(s.json?JSON.stringify(e):String(e))}function o(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(r," ")),s.json?JSON.parse(e):e}catch(n){}}function i(n,a){var t=s.raw?n:o(n);return e.isFunction(a)?a(t):t}var r=/\+/g,s=e.cookie=function(o,r,l){if(void 0!==r&&!e.isFunction(r)){if(l=e.extend({},s.defaults,l),"number"==typeof l.expires){var d=l.expires,f=l.expires=new Date;f.setTime(+f+864e5*d)}return document.cookie=[n(o),"=",t(r),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var c=o?void 0:{},p=document.cookie?document.cookie.split("; "):[],u=0,m=p.length;u<m;u++){var _=p[u].split("="),v=a(_.shift()),y=_.join("=");if(o&&o===v){c=i(y,r);break}o||void 0===(y=i(y))||(c[v]=y)}return c};s.defaults={},e.removeCookie=function(n,a){return void 0!==e.cookie(n)&&(e.cookie(n,"",e.extend({},a,{expires:-1})),!e.cookie(n))}}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},window.LeykaGUIBottom=function(e){this.$=e},window.LeykaGUIBottom.prototype={bindEvents:function(){var e=this,n=e.$;n(".leyka-js-open-form-bottom").on("click",function(e){e.preventDefault();var a=n(this),t=a.closest(".leyka-pf-bottom");n("#"+t.attr("data-target")).find(".amount__figure input.leyka_donation_amount").val(a.parents(".leyka-pf-bottom").find('input[name="leyka_temp_amount"]').val()),t.leykaForm("openFromBottom")})}},jQuery(document).ready(function(e){leykaGUIBottom=new LeykaGUIBottom(e),leykaGUIBottom.bindEvents()}),window.LeykaGUICard=function(e){this.$=e},window.LeykaGUICard.prototype={bindEvents:function(){var e=this;e.$}},jQuery(document).ready(function(e){leykaGUICard=new LeykaGUICard(e),leykaGUICard.bindEvents()}),window.LeykaGUIFinal=function(e){this.$=e,e(".leyka-pf__final-informyou .informyou-redirect-text").show()},window.LeykaGUIFinal.prototype={bindEvents:function(){function e(e,n,t){return n.length?a.cookie(e,n):t?a.cookie(e,""):a.cookie(e)?a.cookie(e):""}var n=this,a=n.$,t=a(".leyka-success-form"),o=e("leyka_donation_id","",!1);o&&t.each(function(e,n){var t=a(n),i=t.find('input[name="leyka_donation_id"]');i.val()||(i.val(o),t.show())}),t.on("submit",function(e){e.preventDefault(),n.validateForm(this)&&n.subscribeUser()}),a(".leyka-js-no-subscribe").on("click",function(e){e.preventDefault(),a(this).closest(".leyka-final-subscribe-form").slideUp(100);var t=a(".leyka-pf__final-thankyou");t.find(".informyou-redirect-text").slideDown(100),n.runRedirectProcess(t)})},validateForm:function(e){var n=this,a=n.$;e=a(e);var t=!1;return e.find(":input").each(function(){var n=a(this),o=n.attr("type"),i=n.attr("name"),r=n.val(),s=e.find("."+i+"-error");1==a.inArray(o,["text","email"])&&(n.hasClass("required")&&!r?(s.show(),n.closest(".donor__textfield").addClass("invalid")):"email"!=o||is_email(r)?(s.hide(),n.closest(".donor__textfield").removeClass("invalid"),t=!0):(s.show(),n.closest(".donor__textfield").addClass("invalid")))}),t},animateRedirectCountdown:function(e){var n=this,a=(n.$,e.find(".informyou-redirect-text .leyka-redirect-countdown")),t=a.text();t=parseInt(t,10),t-=1,t<=0&&clearInterval(n.countdownInterval),a.text(String(t))},runRedirectProcess:function(e){var n=this,a=(n.$,leyka_get_ajax_url());setTimeout(function(){var e;a?(e=a.replace(/\/core\/wp-admin\/.*/,""),e=e.replace(/\/wp-admin\/.*/,"")):e="/",window.location.href=e},4e3),n.countdownInterval=setInterval(n.animateRedirectCountdown.bind(null,e),1e3)},subscribeUser:function(){var e=this,n=e.$,a=n(".leyka-pf__final-informyou");n.post(leyka_get_ajax_url(),n("form.leyka-success-form").serializeArray(),"json").done(function(t){"undefined"!=typeof t.status&&0!=t.status&&"undefined"!=typeof t.message&&n(".leyka-pf__final-error-message").html(t.message).show(),a.show(),e.runRedirectProcess(a)}).always(function(){n(".leyka-pf__final-thankyou").hide()})}},jQuery(document).ready(function(e){leykaGUIFinal=new LeykaGUIFinal(e),leykaGUIFinal.bindEvents()});var leykaValidateForm,leyka;!function(e){function n(e){u(),x(),C(),a()}function a(){d(),f(),l(),o(),i(),r(),s(),t()}function t(){e(".leyka-pf__form").on("submit.leyka","form.leyka-revo-form",function(n){var a=e(this),t=a.find(".step.step--active");if(!t.hasClass("step--person")){if(t.hasClass("step--amount")){var o=a.find(".step.step--amount .step__action--amount a");o.length<2&&o.click()}return!1}if(n.preventDefault(),leykaValidateForm(a)){var i=a.find('input[name="leyka_payment_method"]:checked');if("default"!==i.data("processing"))return void("custom-process-submit-event"!==i.data("processing")&&n.stopPropagation());for(var r=a.closest(".leyka-pf").find(".leyka-pf__redirect"),s=a.serializeArray(),l={action:"leyka_ajax_get_gateway_redirect_data"},d=0;d<s.length;d++)l[s[d].name]=s[d].value;i.data("ajax-without-form-submission")&&(l.without_form_submission=!0),r.addClass("leyka-pf__redirect--open"),e.post(leyka_get_ajax_url(),l).done(function(n){if(n=e.parseJSON(n),!n||"undefined"==typeof n.status)return!1;if(0!==n.status&&"undefined"!=typeof n.message)return!1;if(!n.payment_url)return!1;var a='<form class="leyka-auto-submit" action="'+n.payment_url+'" method="post">';e.each(n,function(e,n){"payment_url"!==e&&(a+='<input type="hidden" name="'+e+'" value="'+n+'">')}),a+="</form>",r.append(a),r.find(".leyka-auto-submit").submit()})}else n.preventDefault(),n.stopPropagation()})}function o(){e(".donor__textfield--name").on("focus","input",function(){e(this).parents(".donor__textfield--name").removeClass("invalid").removeClass("valid").addClass("focus")}).on("blur",":input",function(){var n=e(this),a=n.val();n.parents(".donor__textfield--name").removeClass("focus"),a.length>0?n.parents(".donor__textfield--name").addClass("valid"):n.parents(".donor__textfield--name").addClass("invalid")}),e(".donor__textfield--email").on("focus","input",function(){e(this).parents(".donor__textfield--email").removeClass("invalid").removeClass("valid").addClass("focus")}).on("blur",":input",function(){var n=e(this),a=n.val();n.parents(".donor__textfield--email").removeClass("focus"),a.length>0&&is_email(a)?n.parents(".donor__textfield--email").addClass("valid"):n.parents(".donor__textfield--email").addClass("invalid")}),e(".donor__textfield--comment").on("focus",":input",function(){e(this).parents(".donor__textfield--comment").removeClass("invalid").removeClass("valid").addClass("focus")}).on("blur",":input",function(){var n=e(this),a=n.val();n.parents(".donor__textfield--comment").removeClass("focus"),a.length&&n.data("max-length")&&a.length>n.data("max-length")?n.parents(".donor__textfield--comment").addClass("invalid"):n.parents(".donor__textfield--comment").addClass("valid")})}function i(){e(".leyka-js-oferta-trigger").on("click.leyka",function(n){n.preventDefault(),e(this).parents(".leyka-pf").addClass("leyka-pf--oferta-open")}),e(".leyka-js-oferta-close").on("click.leyka",function(n){n.preventDefault(),e(this).parents(".leyka-pf").find(".donor__oferta").removeClass("invalid").find('input[name="leyka_agree"]').prop("checked",!0),e(this).parents(".leyka-pf").removeClass("leyka-pf--oferta-open")}),e(".donor__oferta").on("change.leyka","input:checkbox",function(){e(".donor__oferta").find("input:checkbox.required:not(:checked)").length?e(this).parents(".donor__oferta").addClass("invalid"):e(this).parents(".donor__oferta").removeClass("invalid")})}function r(){e(".leyka-js-pd-trigger").on("click.leyka",function(n){n.preventDefault(),e(this).parents(".leyka-pf").addClass("leyka-pf--pd-open")}),e(".leyka-js-pd-close").on("click.leyka",function(n){n.preventDefault(),e(this).parents(".leyka-pf").find(".donor__oferta").removeClass("invalid").find('input[name="leyka_agree_pd"]').prop("checked",!0),e(this).parents(".leyka-pf").removeClass("leyka-pf--pd-open")}),e(".donor__oferta").on("change.leyka","input:checkbox",function(){e(".donor__oferta").find("input:checkbox.required:not(:checked)").length?e(this).parents(".donor__oferta").addClass("invalid"):e(this).parents(".donor__oferta").removeClass("invalid")})}function s(){e(".leyka-js-history-close").on("click",function(n){n.preventDefault(),e(this).parents(".leyka-pf--history-open").removeClass("leyka-pf--history-open")}),e(".leyka-js-history-more").on("click",function(n){n.preventDefault(),e(this).parents(".leyka-pf, .leyka-pf-bottom").addClass("leyka-pf--history-open")})}function l(){e(".payment-opt__radio").change(function(){g(e(this))})}function d(){e(".leyka-js-another-step").on("click",function(n){n.preventDefault(),p(e(this))}),e(".leyka-js-complete-donation").click(function(){e(this).closest(".leyka-pf").leykaForm("close")}),e(".leyka-submit-errors").on("click",function(n){n.preventDefault();var a=e(this);a.hide(),c()})}function f(){e(".leyka-js-amount").on("click",function(n){n.preventDefault(),h(e(this))});var n=e(".amount_range").find("input"),a=e(".amount__figure").find("input.leyka_donation_amount");n.on("change input",m),a.on("change input",_),n.on("change input",y),n.on("change input",k),a.on("focus",function(){e(this).parents(".amount__figure").addClass("focus")}).on("blur",function(){e(this).parents(".amount__figure").removeClass("focus")})}function c(){var n=e(this).closest(".leyka-pf");n.find(".payment-opt__radio").prop("checked",!1),n.find(".step").removeClass("step--active"),n.find(".step:first").addClass("step--active"),n.find(".leyka-pf__redirect").removeClass("leyka-pf__redirect--open")}function p(e){var n=e.attr("href"),a=e.closest(".leyka-pf");"cards"===n&&a.find(".payment-opt__radio").prop("checked",!1),a.find(".step").removeClass("step--active"),a.find(".step--"+n).addClass("step--active"),a.find(".leyka-pf__final-screen").removeClass("leyka-pf__final--open").removeClass("leyka-pf__final--open-half")}function u(){e(".amount__figure input.leyka_donation_amount").each(function(){var n=e(this),a=n.parents(".step__fields").find(".amount_range input"),t=parseInt(e(this).val());(!Number.isInteger(t)||t<a.attr("min")||t>a.attr("max"))&&(t=a.data("default-value")),n.val(t),a.val(t);var o=n.closest(".leyka-pf").attr("id");e('div[data-target = "'+o+'"]').find("input").val(t)})}function m(n,a){var t=e(this).val();a&&a.skipSyncFigure||(e(this).parents(".step__fields").find(".amount__figure").find("input.leyka_donation_amount").val(t),e(this).parents(".step__fields").removeClass("invalid"))}function _(){var n=e(this),a=n.val(),t=n.parents(".leyka-pf__form");a||(a=0),t.find(".step--amount .step__fields").removeClass("invalid"),t.find(".amount_range input").val(a).trigger("change",{skipSyncFigure:!0})}function v(e){var n,a,t=e.val();try{n=parseInt(e.attr("min")),a=parseInt(e.attr("max"))}catch(o){n=0,a=0}var i=0;return a&&(i=100*(t-n)/(a-n)),i}function y(){var n=v(e(this)),a=1;for(var t in I)rangePercent=I[t],n>=rangePercent&&(a=parseInt(t)+2);var o=e(".amount__icon .svg-icon");o.find("use").attr("xlink:href","#icon-money-size"+a),o.addClass("icon-money-size"+a),1!=a&&o.removeClass("icon-money-size1");for(var t in I){var i=parseInt(t)+2;a!=i&&o.removeClass("icon-money-size"+i)}}function k(){var n=v(e(this)),a=(F-2*U)*n/100;e(".range-circle").css({left:a+"px"}),e(".range-color-wrapper").width(a+U)}function h(e){var n=e.attr("href"),a=e.parents(".step"),t=e.parents(".leyka-pf__form"),o=a.find(".amount__figure input.leyka_donation_amount"),i=parseInt(o.val());if(!Number.isInteger(i)||i<o.data("min-value")||i>o.data("max-value"))a.find(".step__fields").addClass("invalid");else{if(a.find(".step__fields").removeClass("invalid"),e.hasClass("monthly")){a.find("input.is-recurring-chosen").val(1),t.find(".remembered-amount").text(i),t.find(".remembered-monthly").show();var r=t.find('.payment-opt__radio[data-has-recurring="1"]:first'),s=t.find(".remembered-payment");s.closest(".leyka-js-another-step").attr("href","amount"),r.prop("checked",!0),s.text(r.closest(".payment-opt").find(".payment-opt__label").text())}else a.find("input.is-recurring-chosen").val(0),t.find(".remembered-amount").text(i),t.find(".remembered-monthly").hide(),t.find(".remembered-payment").parents(".leyka-js-another-step").attr("href","cards"),t.find(".payment-opt__radio").prop("checked",!1);a.removeClass("step--active"),t.find(".step--"+n).addClass("step--active")}}function x(){var n=e(".payments-grid");n.find(".payment-opt").length<=4&&n.css("overflow-y","hidden")}function g(n){var a=n.parents(".payment-opt").find(".payment-opt__label").text(),t=n.parents(".step"),o=n.parents(".leyka-pf__form");e("html").addClass("leyka-js--open-modal"),o.find(".remembered-payment").text(a),t.removeClass("step--active");var i=o.find(".step--static."+n.val());i.length>0?i.addClass("step--active"):(o.find(".step--person").addClass("step--active"),e("html").removeClass("leyka-js--open-modal"))}function C(){e(".donor__textfield--name").removeClass("invalid").removeClass("valid"),e(".donor__textfield--email").removeClass("invalid").removeClass("valid"),e(".donor__oferta").removeClass("invalid").removeClass("valid")}function b(){var n=e(this);n.addClass("leyka-pf--active"),e(".leyka-js").addClass("leyka-js--open-modal"),e(".amount_range input").change()}function w(){var n=e(this).attr("data-target"),a=e("#"+n),t=a.find(".amount__figure input"),o=parseInt(t.val());Number.isInteger(o)&&o>=t.attr("min")&&o<=t.attr("max")&&(a.find(".amount__figure input.leyka_donation_amount").val(o),a.find(".amount_range input").val(o)),a.find(".step").removeClass("step--active"),a.find(".step--amount").addClass("step--active"),a.addClass("leyka-pf--active")}function j(){var n=e(this);n.hasClass("leyka-pf--oferta-open")?n.removeClass("leyka-pf--oferta-open"):n.hasClass("leyka-pf--pd-open")?n.removeClass("leyka-pf--pd-open"):(n.removeClass("leyka-pf--active"),e(".leyka-js").removeClass("leyka-js--open-modal"))}var I=[25,50,75],F=200,U=17;leykaValidateForm=function(e){var n=!0,a=e.find(".donor__textfield--email input").val(),t=e.find(".amount__figure input.leyka_donation_amount"),o=parseInt(t.val().replace(/\s/g,"")),i=e.find(":input.leyka-donor-comment"),r=e.find('.donor__oferta input[name="leyka_agree"]'),s=e.find('.donor__oferta input[name="leyka_agree_pd"]');return 0===e.find(".donor__textfield--name input").val().length&&(n=!1,e.find(".donor__textfield--name").addClass("invalid")),0!==a.length&&is_email(a)||(n=!1,e.find(".donor__textfield--email").addClass("invalid")),i.length&&i.data("max-length")&&i.val().length>i.data("max-length")&&(n=!1,e.find(".donor__textfield--comment").addClass("invalid")),(r.length&&!r.prop("checked")||s.length&&!s.prop("checked"))&&(n=!1,e.find(".donor__oferta").addClass("invalid")),(o<=0||o<t.data("min-value")||o>t.data("max-value"))&&(n=!1),n};var D={defaults:{color:"green"},open:b,close:j,openFromBottom:w,init:n};e.fn.leykaForm=function(n){return D[n]?D[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.leykaForm"):D.init.apply(this,arguments)}}(jQuery),window.LeykaPageMain=function(e){var n=this;n.$=e,n.setupNoScroll(),n.initForms(),n.inpageCardColumns(),n.setupCustomRangeControl(),n.bindEvents(),n.handleHashChange()},window.LeykaPageMain.prototype={bindEvents:function(){var e=this,n=e.$;n(".leyka-js-open-form").on("click.leyka",function(e){e.preventDefault(),n(this).closest(".leyka-pf").leykaForm("open")}),n(".leyka-js-close-form").on("click.leyka",function(e){e.preventDefault(),n(this).closest(".leyka-pf").leykaForm("close")}),n(window).resize(function(){e.inpageCardColumns()}),n(window).on("hashchange",function(){e.handleHashChange()})},setupNoScroll:function(){var e=this,n=e.$,a=n(window).scrollTop();n(window).scroll(function(){var e=n(window).scrollTop();n(".leyka-pf").hasClass("leyka-pf--active")?n(window).scrollTop(a):a=e})},initForms:function(){var e=this,n=e.$;n(".leyka-pf").leykaForm()},inpageCardColumns:function(){var e=this,n=e.$,a=n(".leyka-pf");a.each(function(){var e=n(".leyka-pf").width();e>=600?n(this).addClass("card-2col"):n(this).removeClass("card-2col")})},setupCustomRangeControl:function(){var e=this,n=e.$;n(".amount__range_overlay").addClass("amount__range_custom--visible"),n(".amount__range_custom").addClass("amount__range_custom--visible")},handleHashChange:function(){var e=this,n=e.$,a=window.location.hash.substr(1),t=a.split("|");if(t.length>0){var o=t[0],i=n("#"+o);if(i.length>0){i.leykaForm("open");for(var r in t){var s=t[r];e.handleFinalScreenParams(i,s)}}}},handleFinalScreenParams:function(e,n){if(n.search(/final-open/)>-1){e.find(".leyka-pf__final-screen").removeClass("leyka-pf__final--open").removeClass("leyka-pf__final--open-half");var a=n.split("_");try{var t=e.find(".leyka-pf__final-screen.leyka-pf__final-"+a[1]);t.addClass("leyka-pf__final--open"),a[2]&&t.addClass("leyka-pf__final--open-half")}catch(o){}}}},jQuery(document).ready(function(e){leykaPageMain=new LeykaPageMain(e)});